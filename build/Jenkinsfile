pipeline {
    agent none 
    stages {
        stage('create eks cluster: udacity-cluster') {
            agent {
                docker { image 'weaveworks/eksctl:0.32.0' }
            }        
            steps {
                withAWS(credentials: 'aws-creds', region: 'eu-central-1', role: 'udacity-eks-admin') {
                    sh 'aws sts get-caller-identity'
                    sh 'version'
                    sh 'create cluster --name udacity-cluster --region eu-central-1 --version=1.18'
                }
            }
        }
    }
}