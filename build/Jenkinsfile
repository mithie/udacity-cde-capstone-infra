pipeline {
    agent any 
    stages {
        stage('install aws cli') {
            steps {
                sh "curl https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip -o awscliv2.zip"
                sh "unzip -n awscliv2.zip"
                sh "./aws/install --update"
                sh "aws --version"
            }
        }

        stage('create cluster') {
            steps {
                withAWS(credentials: 'aws-creds', region: 'eu-central-1') {
                    sh 'aws configure list'
                    sh 'aws sts get-caller-identity'
                    sh 'aws s3 ls'
                }
            }
        }
    }
}